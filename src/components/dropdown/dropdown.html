<div class="m-dropdown" ref="mDropdown" :class="{ 'm--is-disabled': disabled, 'm--is-waiting': waiting }" :style="{ maxWidth: width }">
    <m-popup :placement="bottom-start"
             :disabled="inactive"
             :open="open"
             :enter="transitionEnter"
             :after-enter="transitionAfterEnter"
             :leave="transitionLeave"
             :padding-header="false"
             :padding-body="false"
             :focus-management="false"
             :open-on-click="false"
             width="100%"
             ref="popper"
             @open="onOpen">
        <!-- <template slot="header" v-if="hasLabel && isMqMaxS">
            <h2 class="m-dropdown__header__label">{{ label }}</h2>
            <div class="m-dropdown__header__research" v-if="editable">
                <input type="text"
                       class="m-dropdown__header__research-input"
                       :placeholder="researchText"
                       v-model="textElement">
                <m-button mode="icon" icon-name="default" @click="focusOnResearchInput">
                    <m-i18n k="m-dropdown:search"></m-i18n>
                </m-button>
            </div>
        </template> -->
        <ul class="m-dropdown__list"
            ref="mDropdownElements"
            slot="body">
            <slot></slot>
            <m-dropdown-item v-if="!hasItems && !dirty" :no-data-default-item="true">{{ propTextNoData }}</m-dropdown-item>
            <m-dropdown-item v-if="!hasItems && dirty" :no-data-default-item="true">{{ propTextNoMatch }}</m-dropdown-item>
        </ul>

        <template slot="footer" v-if="hasFooterSlot">
            <slot name="footer"></slot>
        </template>
        <m-text-field ref="mDropdownTextField"
                      mode="dropdown"
                      :label="label"
                      v-model="selectedText"
                      :state="propState"
                      :editable="editable"
                      :force-focus="open"
                      :placeholder="defaultText"
                      :disabled="disabled"
                      :waiting="waiting"
                      :error-message="errorMessage"
                      :valid-message="validMessage"
                      :helper-message="helperMessage"
                      @keydown.native.enter.prevent="onKeydown($event)"
                      @keydown.native.return.prevent="onKeydown($event)"
                      @keydown.native.space.prevent="onKeydown($event)"
                      @keydown.native.esc.prevent="onKeydown($event)"
                      @keydown.native.up.prevent="onKeydown($event)"
                      @keydown.native.down.prevent="onKeydown($event)"
                      @keydown="onKeydown2($event)"
                      @focus="onFocus($event)"
                      @blur="onBlur($event)"
                      @mousedown="onMousedown($event)">
        </m-text-field>
        <!-- <m-button mode="icon" icon-name="default" icon-size="13px" class="m-dropdown__icon-clear" v-if="this.hasModel &&!disabled && !waiting" @click="clearField">Clear field</m-button> -->
    </m-popup>
    <m-validation-message
        :error-message="propErrorMessage"
        :valid-message="propValidMessage"
        :helper-message="helperMessage"></m-validation-message>
</div>
