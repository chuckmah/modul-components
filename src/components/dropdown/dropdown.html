<div class="m-dropdown" ref="mDropdown" :class="{ 'is-disabled': stateDisabled }">
    <ul class="m-dropdown__list is-hidden" aria-hidden="true">
        <li class="m-dropdown__list__element">
            <span class="m-dropdown__list__element__text" ref="mDropdownCalculate"></span>
        </li>
    </ul>

    <m-popper trigger="click"
              :options="{ placement: 'bottom' }"
              :closeOnContentClick="true"
              :closeOnReferenceClick="false"
              :disabled="stateDisabled"
              mode="dropdown"
              @show="listOpen(true)"
              @hide="listOpen(false)">
        <ul class="m-dropdown__list"
            ref="mDropdownElements">
            <li v-for="(element, index) in elementsSortedFiltered"
                v-if="elementsCount > 0"
                class="m-dropdown__list__element"
                :class="{ 'is-selected': element === propsSelectedElement }"
                :key="index"
                @click="selectElement($event, element)">
                <a class="m-dropdown__list__element__text"
                   :data-index="index"
                   @keyup="keyupItem($event, index)"
                   tabindex="0">{{ getElementListText(element) }}</a>
            </li>
            <li v-if="elementsCount <= 0"
                class="m-dropdown__list__element">
                <span class="m-dropdown__list__element__text"><m-i18n i18n-key="m-dropdown:no-result"></m-i18n></span>
            </li>
        </ul>

        <m-text-field ref="mDropdownValue"
                      slot="reference"
                      :value="textElement"
                      :state="state"
                      :isEditable="isEditable"
                      @valueChanged="textElement = $event"
                      @keyup="keyupList">
                      <slot></slot>
        </m-text-field>
    </m-popper>
</div>
